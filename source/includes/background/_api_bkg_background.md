# Background Information

This section provides important information about the World Markets Platform software.

## Message Frame

> A JSON-formatted frame object.

```json
{
    "m": 0,
    "i": 0,
    "n":"function name",
    "o":"payload"
}
```

Wrap all calls in a JSON-formatted frame object. Responses from the server are similarly wrapped. The API calls are documented as payloads by function name.

| Key                 | Value                                                        |
| ------------------- | ------------------------------------------------------------ |
| *m* message type    | **integer.** The type of the message.  One of:<br />0 request<br />1 reply<br />2 subscribe-to event<br />3 event<br />4 unsubscribe-from event<br />5 error |
| *i* sequence number | **long integer.** The sequence number identifies an individual request or request-and-response pair, to your application.<br /><br />The system requires a non-zero sequence number, but the numbering scheme you use is up to you. No arbitrary sequence numbering scheme is enforced by World Markets.<br /><br />**Best Practices:** A client-generated API call (of message types 0, 2, and 4) should:<br />Carry an even sequence number<br />Begin at the start of each user session<br />Be unique within each user session.<br />Begin with 2 (as in 2, 4, 6, 8)<br /><br />Message types 1 (reply), 3 (event), and 5 (error) are generated by the server. These messages echo the sequence number of the message to which they respond. See the example, following. |
| *n* function name   | **string.** The function name is the name of the function being called or that the server is responding to. The server echoes your call. See the example, following. |
| *o* payload         | Payload is a JSON-formatted string containing the data being sent with the message. Payload may consist of request parameters (key-value pairs) or response parameters. |

<aside class="notice"><strong>Note: </strong>You can send the key-value pairs inside the payload in any order. The server controls the order of its response.</aside>

### Example 1

> Example 1

```javascript
var frame =
{
    "m":0,
    "i":0,
    "n":"function name",
    "o":""
};

var requestPayload =
{
    "parameter1":"value",
    "parameter2":0
};

frame.o = json.Stringify(requestPayload);
// Stringify escapes the payload's quotation marks automatically.
WS.Send(json.Sringify(frame)); // WS.Send escapes the frame
```

When sending a request in the frame to the software using JavaScript, a call looks like Example 1.

> Example 2

### Example 2

```javascript
var frame = json.Parse(wsMessage);

if (frame.m == 1) // message of type reply
{
    //This is a reply
    if (frame.n == "WebAuthenticateUser")
    {
        var LoginReply = json.Parse(frame.o);
        if (loginReply.Authenticated)
        {
            var user = LoginReplay.User;
        }
    }
}
```

When receiving a frame from the software, use the frame to determine the context, and then unwrap the content, as in Example 2.

<aside class="notice"><strong>Note: </strong>If not using JSON Stringify, escape quotation marks.</aside>

## Standard response objects and common error codes

A response to an API call usually consists of a specific response, but both successful and unsuccessful responses may consist of a generic response object that verifies only that the call was received, and not that the action requested by the call took place. A generic response to an unsuccessful call provides an error code. A generic response looks like Example 3.

### Example 3

> Example 3

```json
{
    "result":true,
    "errormsg":"",
    "errorcode": 0,
    "detail":"",
}
```

| Key       | Value                                                        |
| --------- | ------------------------------------------------------------ |
| result    | **Boolean.** If the call has been successfully received by the Order Management System, result is *true*; otherwise it is *false*. |
| errormsg  | **string.** A successful receipt of the call returns *null*. The *errormsg* key for an unsuccessful call returns one of the following messages:<br />Not Authorized (errorcode 20)<br />Invalid Response (errorcode 100)<br />Operation Failed (errorcode 101)<br />Server Error (errorcode 102)<br />Resource Not Found (errorcode 104) |
| errorcode | **integer.** A successful receipt of the call returns 0. An unsuccessful receipt of the call returns one of the *errorcodes* shown in the *errormsg* list. |
| detail    | **string.** Message text that the system may send. The content of this key is usually *null*. |

## Modules

The World Markets software consists of several modules that include the Order Management System (OMS), the matching engine, and the Asset Manager. During installation, each is assigned an ID.

The Order Management System is the mechanism that manages access to the trading venue. The OMS controls permissions, accounts, and users. The OMS must be specified in many calls.

The order book resides on the World Markets matching engine.

A trading venue is a combination of OMS and matching engine that creates a place to access the market and trade. A venue maintains its order book and matching engine, and may access several Order Management Systems.

The Asset Manager controls the deposit and withdrawal of funds belonging to an account. These funds can be denominated in any product that the trading venue allows.

## Users, Accounts, and Permissions

The World Markets software differentiates between *user* and *account*. A user is the person who logs in; an account represents the funds and trading that the user does &mdash; much like a bank account represents funds and checks.

As with a bank account, an individual user may have multiple Exchange accounts. Similarly, multiple users may trade through a single account. There may be users who have trading access to one set of accounts that overlap (but do not duplicate) the set of accounts that another user can access. There may be a many-to-many relationship where two or more users have access to a set of accounts.

The use case for this kind of "joint tenancy" is an active trading desk where a specific individual may not always be present. If User A will not be present, User B can monitor and trade on the market. User A may wish to cancel his pending trades for a specific account or instrument, but not those of his trading partner under the same account or for the same instrument.

Permissions handle the rules that determine what a user can access and do with orders, cancellations, and the other tasks of a trading venue. Most permissions encompass tasks such as trading, depositing, or withdrawing funds; but a permission can be set for each API call for each individual in the venue.

An administrator with Operator permission sets up a user's permissions on the OMS when the user joins the trading venue, and only an administrator with Operator permission or above can change them. A full discussion of permissions is not part of this API.

## Products and Instruments

In World Markets platform, a *product* is an asset that is tradable or paid out. A product might be a national currency, a crypto-currency, or something else such as a commodity. For example, a product might be a US Dollar r or a BitCoin or an ounce of gold. Transaction and withdrawal fees are denominated in products. (Products may be referred to as *assets* in some API calls.)

An *instrument* is a pair of exchanged products (or fractions of them). For example, US Dollar for BitCoin. In conventional investment parlance, a stock or a bond is called an instrument, but implicit in that is the potential exchange of one product for another (stock for dollars). World Markets software thinks of that exchange as explicit, and separates product from instrument.

## Quotes and Orders

The World Markets API includes calls related to both quotes and orders. Quoting is not enabled for the retail end user of World Markets software. Only registered market participants or marketmakers may quote. Your trading venue may offer quotes separately from orders.

- A quote expresses a willingness to buy or sell at a given price.
- An order is a directive to buy or sell.

In this version of the World Markets matching engine software, quotes and orders are synonymous. They both can buy or sell. This is because the matching engine (like most matching engines) requires a "firm quote" &mdash; a guaranteed bid or ask.

For both quotes and orders, trading priority is the same, and no preference is given one over the other. In code, the matching engine flags a quote for eventual regulatory and compliance rules, but for current software operation and trade execution, quotes and orders behave equivalently.

### Best Practices/Quotes and Orders

Use the order-related API calls in preference to quote-related calls unless you specifically require quote-related calls.

## Time&ndash; and Date-Stamp Formats

World Markets software uses two different time&ndash; and date-stamp formats, POSIX and Microsoft Ticks. Where the value of a time field key is an integer or long, the value is in POSIX format; when the value of a time field key is a string, it is in Microsoft Ticks format (also called *datetime*).

- **POSIX** stores date/time values as the number of seconds since 1 January 1970 (long integer). World Markets software often multiples this number by 1000 for the number of milliseconds since 1 January 1970. **Recognize POSIX format:** POSIX format is a long integer. It is usually formatted like this: `1501603632000`<br /><br />
- **Microsoft Ticks** (datetime) format represents the number of ticks that have elapsed since 00:00:00 UTC, 1 January 0001, in the Gregorian calendar. A single tick represents one hundred nanoseconds (one ten-millionth of a second). There are 10,000 ticks in a millisecond; ten million ticks in a second. Ticks format does not include the number of ticks attributable to leap-seconds. **Recognize Ticks format:** Ticks format is a string. In World Markets software, it is usually formatted like this: `"2018-08-17T17:57:56Z"` Note that a T (for time) separates the initial date from the time. The trailing Z represents the time zone, in all cases in World Markets software, this is UTC (also called Zulu time).

## The Trading Day

Most World Markets installations operate 24-hour computer-based trading venues. The trading day runs from UTC Midnight to UTC Midnight (essentially, London time, but without any summertime offset), regardless of the nominal location of the venue. Values such as open or close are those values as of UTC Midnight. Values for day, month, or annual periods run from UTC Midnight to UTC Midnight.
